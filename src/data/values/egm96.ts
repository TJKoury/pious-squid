import { factorial } from "../../math/operations";

export interface Egm96Data {
  l: number;
  m: number;
  clm: number;
  slm: number;
}

const EGM_96_NORMALIZED: [number, number, number, number][] = [
  [2, 0, -0.484165371736e-3, 0.0],
  [2, 1, -0.186987635955e-9, 0.119528012031e-8],
  [2, 2, 0.243914352398e-5, -0.140016683654e-5],
  [3, 0, 0.957254173792e-6, 0.0],
  [3, 1, 0.202998882184e-5, 0.248513158716e-6],
  [3, 2, 0.904627768605e-6, -0.619025944205e-6],
  [3, 3, 0.721072657057e-6, 0.141435626958e-5],
  [4, 0, 0.539873863789e-6, 0.0],
  [4, 1, -0.536321616971e-6, -0.473440265853e-6],
  [4, 2, 0.350694105785e-6, 0.66267157254e-6],
  [4, 3, 0.990771803829e-6, -0.200928369177e-6],
  [4, 4, -0.188560802735e-6, 0.308853169333e-6],
  [5, 0, 0.68532347563e-7, 0.0],
  [5, 1, -0.621012128528e-7, -0.944226127525e-7],
  [5, 2, 0.652438297612e-6, -0.323349612668e-6],
  [5, 3, -0.451955406071e-6, -0.214847190624e-6],
  [5, 4, -0.295301647654e-6, 0.496658876769e-7],
  [5, 5, 0.174971983203e-6, -0.669384278219e-6],
  [6, 0, -0.149957994714e-6, 0.0],
  [6, 1, -0.760879384947e-7, 0.262890545501e-7],
  [6, 2, 0.481732442832e-7, -0.373728201347e-6],
  [6, 3, 0.571730990516e-7, 0.902694517163e-8],
  [6, 4, -0.862142660109e-7, -0.471408154267e-6],
  [6, 5, -0.26713332549e-6, -0.536488432483e-6],
  [6, 6, 0.967616121092e-8, -0.237192006935e-6],
  [7, 0, 0.90978937145e-7, 0.0],
  [7, 1, 0.279872910488e-6, 0.954336911867e-7],
  [7, 2, 0.329743816488e-6, 0.930667596042e-7],
  [7, 3, 0.250398657706e-6, -0.217198608738e-6],
  [7, 4, -0.275114355257e-6, -0.123800392323e-6],
  [7, 5, 0.193765507243e-8, 0.177377719872e-7],
  [7, 6, -0.358856860645e-6, 0.151789817739e-6],
  [7, 7, 0.109185148045e-8, 0.244415707993e-7],
  [8, 0, 0.496711667324e-7, 0.0],
  [8, 1, 0.233422047893e-7, 0.590060493411e-7],
  [8, 2, 0.802978722615e-7, 0.654175425859e-7],
  [8, 3, -0.191877757009e-7, -0.863454445021e-7],
  [8, 4, -0.244600105471e-6, 0.700233016934e-7],
  [8, 5, -0.255352403037e-7, 0.891462164788e-7],
  [8, 6, -0.657361610961e-7, 0.309238461807e-6],
  [8, 7, 0.672811580072e-7, 0.747440473633e-7],
  [8, 8, -0.124092493016e-6, 0.120533165603e-6],
  [9, 0, 0.276714300853e-7, 0.0],
  [9, 1, 0.143387502749e-6, 0.216834947618e-7],
  [9, 2, 0.222288318564e-7, -0.322196647116e-7],
  [9, 3, -0.160811502143e-6, -0.742287409462e-7],
  [9, 4, -0.900179225336e-8, 0.194666779475e-7],
  [9, 5, -0.166165092924e-7, -0.541113191483e-7],
  [9, 6, 0.626941938248e-7, 0.222903525945e-6],
  [9, 7, -0.118366323475e-6, -0.965152667886e-7],
  [9, 8, 0.188436022794e-6, -0.308566220421e-8],
  [9, 9, -0.477475386132e-7, 0.966412847714e-7],
  [10, 0, 0.526222488569e-7, 0.0],
  [10, 1, 0.835115775652e-7, -0.131314331796e-6],
  [10, 2, -0.942413882081e-7, -0.51579165739e-7],
  [10, 3, -0.689895048176e-8, -0.153768828694e-6],
  [10, 4, -0.840764549716e-7, -0.792806255331e-7],
  [10, 5, -0.493395938185e-7, -0.505370221897e-7],
  [10, 6, -0.375885236598e-7, -0.795667053872e-7],
  [10, 7, 0.811460540925e-8, -0.336629641314e-8],
  [10, 8, 0.404927981694e-7, -0.918705975922e-7],
  [10, 9, 0.125491334939e-6, -0.376516222392e-7],
  [10, 10, 0.100538634409e-6, -0.24014844952e-7],
  [11, 0, -0.509613707522e-7, 0.0],
  [11, 1, 0.151687209933e-7, -0.268604146166e-7],
  [11, 2, 0.186309749878e-7, -0.990693862047e-7],
  [11, 3, -0.309871239854e-7, -0.14813180426e-6],
  [11, 4, -0.389580205051e-7, -0.63666651198e-7],
  [11, 5, 0.377848029452e-7, 0.494736238169e-7],
  [11, 6, -0.118676592395e-8, 0.344769584593e-7],
  [11, 7, 0.411565188074e-8, -0.898252808977e-7],
  [11, 8, -0.5984108413e-8, 0.243989612237e-7],
  [11, 9, -0.314231072723e-7, 0.417731829829e-7],
  [11, 10, -0.521882681927e-7, -0.183364561788e-7],
  [11, 11, 0.460344448746e-7, -0.696662308185e-7],
  [12, 0, 0.377252636558e-7, 0.0],
  [12, 1, -0.540654977836e-7, -0.435675748979e-7],
  [12, 2, 0.142979642253e-7, 0.320975937619e-7],
  [12, 3, 0.393995876403e-7, 0.244264863505e-7],
  [12, 4, -0.686908127934e-7, 0.415081109011e-8],
  [12, 5, 0.30941112873e-7, 0.782536279033e-8],
  [12, 6, 0.341523275208e-8, 0.391765484449e-7],
  [12, 7, -0.186909958587e-7, 0.356131849382e-7],
  [12, 8, -0.253769398865e-7, 0.169361024629e-7],
  [12, 9, 0.422880630662e-7, 0.252692598301e-7],
  [12, 10, -0.617619654902e-8, 0.308375794212e-7],
  [12, 11, 0.112502994122e-7, -0.637946501558e-8],
  [12, 12, -0.24953260739e-8, -0.1117806019e-7],
  [13, 0, 0.422982206413e-7, 0.0],
  [13, 1, -0.513569699124e-7, 0.390510386685e-7],
  [13, 2, 0.559217667099e-7, -0.627337565381e-7],
  [13, 3, -0.219360927945e-7, 0.974829362237e-7],
  [13, 4, -0.313762599666e-8, -0.119627874492e-7],
  [13, 5, 0.590049394905e-7, 0.664975958036e-7],
  [13, 6, -0.359038073075e-7, -0.657280613686e-8],
  [13, 7, 0.253002147087e-8, -0.621470822331e-8],
  [13, 8, -0.983150822695e-8, -0.104740222825e-7],
  [13, 9, 0.247325771791e-7, 0.452870369936e-7],
  [13, 10, 0.41032465393e-7, -0.36812102948e-7],
  [13, 11, -0.443869677399e-7, -0.476507804288e-8],
  [13, 12, -0.312622200222e-7, 0.878405809267e-7],
  [13, 13, -0.612759553199e-7, 0.685261488594e-7],
  [14, 0, -0.242786502921e-7, 0.0],
  [14, 1, -0.186968616381e-7, 0.294747542249e-7],
  [14, 2, -0.367789379502e-7, -0.516779392055e-8],
  [14, 3, 0.358875097333e-7, 0.204618827833e-7],
  [14, 4, 0.183865617792e-8, -0.226780613566e-7],
  [14, 5, 0.287344273542e-7, -0.163882249728e-7],
  [14, 6, -0.194810485574e-7, 0.247831272781e-8],
  [14, 7, 0.375003839415e-7, -0.417291319429e-8],
  [14, 8, -0.350946485865e-7, -0.153515265203e-7],
  [14, 9, 0.320284939341e-7, 0.288804922064e-7],
  [14, 10, 0.390329180008e-7, -0.144308452469e-8],
  [14, 11, 0.153970516502e-7, -0.390548173245e-7],
  [14, 12, 0.840829163869e-8, -0.311327189117e-7],
  [14, 13, 0.322147043964e-7, 0.45189722496e-7],
  [14, 14, -0.518980794309e-7, -0.481506636748e-8],
  [15, 0, 0.147910068708e-8, 0.0],
  [15, 1, 0.100817268177e-7, 0.109773066324e-7],
  [15, 2, -0.213942673775e-7, -0.308914875777e-7],
  [15, 3, 0.521392929041e-7, 0.172892926103e-7],
  [15, 4, -0.408150084078e-7, 0.650174707794e-8],
  [15, 5, 0.124935723108e-7, 0.808375563996e-8],
  [15, 6, 0.331211643896e-7, -0.368246004304e-7],
  [15, 7, 0.596210699259e-7, 0.531841171879e-8],
  [15, 8, -0.322428691498e-7, 0.221523579587e-7],
  [15, 9, 0.128788268085e-7, 0.375629820829e-7],
  [15, 10, 0.104688722521e-7, 0.147222147015e-7],
  [15, 11, -0.111675061934e-8, 0.180996198432e-7],
  [15, 12, -0.323962134415e-7, 0.155243104746e-7],
  [15, 13, -0.283933019117e-7, -0.422066791103e-8],
  [15, 14, 0.51916885933e-8, -0.243752739666e-7],
  [15, 15, -0.190930538322e-7, -0.471139421558e-8],
  [16, 0, -0.315322986722e-8, 0.0],
  [16, 1, 0.258360856231e-7, 0.325447560859e-7],
  [16, 2, -0.233671404512e-7, 0.288799363439e-7],
  [16, 3, -0.336019429391e-7, -0.22041898801e-7],
  [16, 4, 0.402316284314e-7, 0.483837716909e-7],
  [16, 5, -0.129501939245e-7, -0.319458578129e-8],
  [16, 6, 0.140239252323e-7, -0.350760208303e-7],
  [16, 7, -0.708412635136e-8, -0.881581561131e-8],
  [16, 8, -0.209018868094e-7, 0.50052739053e-8],
  [16, 9, -0.218588720643e-7, -0.395012419994e-7],
  [16, 10, -0.117529900814e-7, 0.114211582961e-7],
  [16, 11, 0.187574042592e-7, -0.303161919925e-8],
  [16, 12, 0.195400194038e-7, 0.666983574071e-8],
  [16, 13, 0.138196369576e-7, 0.102778499508e-8],
  [16, 14, -0.193182168856e-7, -0.386174893776e-7],
  [16, 15, -0.145149060142e-7, -0.327443078739e-7],
  [16, 16, -0.379671710746e-7, 0.302155372655e-8],
  [17, 0, 0.197605066395e-7, 0.0],
  [17, 1, -0.254177575118e-7, -0.306630529689e-7],
  [17, 2, -0.195988656721e-7, 0.64926589341e-8],
  [17, 3, 0.564123066224e-8, 0.678327095529e-8],
  [17, 4, 0.707457075637e-8, 0.249437600834e-7],
  [17, 5, -0.154987006052e-7, 0.660021551851e-8],
  [17, 6, -0.118194012847e-7, -0.289770975177e-7],
  [17, 7, 0.242149702381e-7, -0.422222973697e-8],
  [17, 8, 0.388442097559e-7, 0.358904095943e-8],
  [17, 9, 0.381356493231e-8, -0.281466943714e-7],
  [17, 10, -0.388216085542e-8, 0.181328176508e-7],
  [17, 11, -0.157356600363e-7, 0.106560649404e-7],
  [17, 12, 0.288013010655e-7, 0.203450136084e-7],
  [17, 13, 0.165503425731e-7, 0.204667531435e-7],
  [17, 14, -0.141983872649e-7, 0.114948025244e-7],
  [17, 15, 0.542100361657e-8, 0.532610369811e-8],
  [17, 16, -0.301992205043e-7, 0.365331918531e-8],
  [17, 17, -0.343086856041e-7, -0.198523455381e-7],
  [18, 0, 0.508691038332e-8, 0.0],
  [18, 1, 0.721098449649e-8, -0.388714473013e-7],
  [18, 2, 0.140631771205e-7, 0.100093396253e-7],
  [18, 3, -0.507232520873e-8, -0.490865931335e-8],
  [18, 4, 0.548759308217e-7, -0.13526711772e-8],
  [18, 5, 0.548710485555e-8, 0.264338629459e-7],
  [18, 6, 0.146570755271e-7, -0.136438019951e-7],
  [18, 7, 0.675812328417e-8, 0.688577494235e-8],
  [18, 8, 0.307619845144e-7, 0.417827734107e-8],
  [18, 9, -0.18847060188e-7, 0.368302736953e-7],
  [18, 10, 0.527535358934e-8, -0.466091535881e-8],
  [18, 11, -0.72962851896e-8, 0.19521520802e-8],
  [18, 12, -0.297449412422e-7, -0.164497878395e-7],
  [18, 13, -0.627919717152e-8, -0.348383939938e-7],
  [18, 14, -0.81560533641e-8, -0.128636585027e-7],
  [18, 15, -0.405003412879e-7, -0.202684998021e-7],
  [18, 16, 0.104141042028e-7, 0.661468817624e-8],
  [18, 17, 0.358771586841e-8, 0.448065587564e-8],
  [18, 18, 0.312351953717e-8, -0.109906032543e-7],
  [19, 0, -0.325780965394e-8, 0.0],
  [19, 1, -0.759903885319e-8, 0.126835472605e-8],
  [19, 2, 0.353541528655e-7, -0.131346303514e-8],
  [19, 3, -0.974103607309e-8, 0.150662259043e-8],
  [19, 4, 0.157039009057e-7, -0.761677383811e-8],
  [19, 5, 0.109629213379e-7, 0.283172176438e-7],
  [19, 6, -0.408745178658e-8, 0.186219430719e-7],
  [19, 7, 0.478275337044e-8, -0.7172834559e-8],
  [19, 8, 0.29490836428e-7, -0.993037002883e-8],
  [19, 9, 0.307961427159e-8, 0.694110477214e-8],
  [19, 10, -0.338415069043e-7, -0.737981767136e-8],
  [19, 11, 0.160443652916e-7, 0.996673453483e-8],
  [19, 12, -0.247106581581e-8, 0.916852310642e-8],
  [19, 13, -0.74471737998e-8, -0.282584466742e-7],
  [19, 14, -0.470502589215e-8, -0.129526697983e-7],
  [19, 15, -0.176580549771e-7, -0.140350990039e-7],
  [19, 16, -0.216950096188e-7, -0.724534721567e-8],
  [19, 17, 0.290444936079e-7, -0.15345653107e-7],
  [19, 18, 0.348382199593e-7, -0.954146344917e-8],
  [19, 19, -0.25734934943e-8, 0.483151822363e-8],
  [20, 0, 0.222384610651e-7, 0.0],
  [20, 1, 0.516303125218e-8, 0.669626726966e-8],
  [20, 2, 0.198831128238e-7, 0.175183843257e-7],
  [20, 3, -0.362601436785e-8, 0.379590724141e-7],
  [20, 4, 0.242238118652e-8, -0.211057611874e-7],
  [20, 5, -0.107042562564e-7, -0.771860083169e-8],
  [20, 6, 0.11047483757e-7, -0.217720365898e-8],
  [20, 7, -0.210090282728e-7, -0.223491503969e-10],
  [20, 8, 0.442419185637e-8, 0.183035804593e-8],
  [20, 9, 0.178846216942e-7, -0.663940865358e-8],
  [20, 10, -0.325394919988e-7, -0.512308873621e-8],
  [20, 11, 0.138992707697e-7, -0.187706454942e-7],
  [20, 12, -0.63575060075e-8, 0.180260853103e-7],
  [20, 13, 0.275222725997e-7, 0.690887077588e-8],
  [20, 14, 0.115841169405e-7, -0.143176160143e-7],
  [20, 15, -0.260130744291e-7, -0.784379672413e-9],
  [20, 16, -0.124137147118e-7, -0.277500443628e-9],
  [20, 17, 0.43690966796e-8, -0.137420446198e-7],
  [20, 18, 0.151842883022e-7, -0.808429903142e-9],
  [20, 19, -0.314942002852e-8, 0.106505202245e-7],
  [20, 20, 0.401448327968e-8, -0.120450644785e-7]
];

export const EGM_96_DENORMALIZED = (() => {
  const output: Egm96Data[] = [];
  for (const coeffs of EGM_96_NORMALIZED) {
    const [l, m, clm, slm] = coeffs;
    const k = m === 0 ? 1 : 2;
    const a = factorial(l + m);
    const b = factorial(l - m) * k * (2 * l + 1);
    const nFac = Math.sqrt(a / b);
    output.push({ l: l, m: m, clm: clm / nFac, slm: slm / nFac });
  }
  return output;
})();
